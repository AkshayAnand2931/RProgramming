# **Data Analytics Worksheet 1 Part 1**

### Akshay Anand

### PES1UG21CS064

# Exploring Data with R

## Prerequisites

This worksheet aims to develop your understanding of summary statistics and basic visualizations through a pragmatic approach.You can download the dataset from [here](https://github.com/200Richa/UE21CS342AA2-Data-Analytics/blob/main/movie_dataset.csv).

## Resources

-   Check out [this](https://intro2r.com/) beautifully comprehensive resource for everything you need to get started with R.
-   [This online book](https://r-graphics.org/) provides guided explananations about visualizations in R using the ggplot2 library.

Use the following libraries and read the dataset:

```{r import, message=FALSE, warning=FALSE, results=TRUE}

char_preds <- read.csv('movie_dataset.csv')
```

## About the Data

To make this worksheet interesting for you all, we have picked this dataset from Kaggle which comprises of the Movies and the metadata associated with it collected using The Movie Database (TMDB). You can download the dataset from [here](https://github.com/200Richa/UE21CS342AA2-Data-Analytics/blob/main/movie_dataset.csv). This dataset is the subset of this [Kaggle dataset](https://www.kaggle.com/datasets/tmdb/tmdb-movie-metadata).

### Data Dictionary

```         
title - Name or Title of the movie.
budget - The budget of the movie in American Dollar(USD).
genres - The genres for  the entire movie. 
id - The identifier for the movie in The Movie Database(TMDB).
original_language - The language associated with the original version of the 
                    film.
popularity - Lifetime popularity score of a movie that is impacted by attributes 
             like number of votes, number of views, etc.
release_date - The release date of the movie.
revenue - The revenue generated by the movie in American Dollar(USD).
runtime - The duration of the movie in minutes.
vote_average - The average of all the votes on the scale of 10.
vote_count - The number of votes for a movie.
director - The director of the movie.
```

## Assignment Submission Format

The following problems are to be completed using the R programming language and should be submitted as a R markdown file (.rmd). Since the dataset is public and many of you students will have the same numerical answers, the grades are allocated on the analysis of the problems and personalized answers within the conclusion section.

## Preliminary Guided Exercises

Make sure you have the R programming language installed on your system. It is also recommended to make sure RStudio, the popular IDE for R, is installed. RStudio provides a lot of useful functionality like R markdown, a script editor and GitHub integration. Use RStudio Projects as a great way of keeping each week's assignment work organized.

1.  **Data Import**

    To import data from CSV files into a DataFrame:

    ```{r}
        data <- read.csv('movie_dataset.csv', header=TRUE)
    ```

    The header = TRUE argument specifies that the first row of your data contains the variable names. If this is not the case you can specify header = FALSE (this is the default value so you can omit this argument entirely).

2.  **Compact Summary**

    Use the str() function to return a compact and informative summary of the DataFrame.

    ```{r}
        str(data)
    ```

    Here we see that data is a 'data.frame' object which contains 4041 rows and 12 variables (columns). Each of the variables are listed along with their data class and the first 10 values.

3.  **Summary Statistics**

    To access the data in any of the variables (columns) in our data frame we can use the \$ notation. Indexing in R starts at 1, which means the first element is at index 1. Access the first 10 values of the title column:

    ```{r}
        data$title[1:10]
    ```

    We can assign a column to another variable and calculate a mean of a numeric variable or get a summary of a variable using the summary() function.

    ```{r}
        movie_names <- data$title
        summary(movie_names)
    ```

```{r}
    movie_budget <- data$budget
    mean(movie_budget)
```

```{r}
    summary(movie_budget)
```

Notice how the behavior of the summary function changes with different types of variables. Let's now try to explore how we can visualize our data.

4.  **Scatter Plots and Line Plots**

    The most common high level function used to produce plots in R is the plot function.

    ```{r}
        par(mfrow = c(1,2)) # To plot different plots in the same row

        plot(data$budget, type="p") # scatter plot
        plot(data$revenue, type="l") # line plot
    ```

    The horizontal axis in these scatter plots represents the index or the row number of data point.

5.  **Sorting a data frame**

    To sort a dataframe with respect to a column we can use the order() function. Let us sort the dataframe to get the top 10 highest grossing movies.

    ```{r}
        sorted_data <- data[order(data$revenue, decreasing = TRUE), ] # To sort in descending order

        # The head function is used to get the first 10 rows
        top_10_rows <- head(sorted_data, n = 10)
        top_10_rows
        
    ```

6.  **Column Transformation**

    Highest Revenue might not be the right indicator for a successful movie. So lets plot the ROI (Return on Investment for all movies)

    ROI = Net Return/Cost of Investment

    ```{r}
        data$ROI = data$revenue / data$budget

        # Print the first 5 rows with their title and ROI
        data[1:5, c("title", "ROI")]
    ```

    Next, you can sort the data frame with respect to ROI to get movies with highest returns.

7.  **Data Pre-processing**

    A lot of times real-world datasets are not curated and cleaned. Values are not stored in proper formats and hence requires cleaning and appropriate transformation before the data is suitable for analysis. In our case we see that the genre is stored as a string. Lets us split the string to get all genre labels.

```{r}
  # Convert the space-separated string of genres to a list of genres for each movie
  data$genres <- strsplit(data$genres, " ")
  #data$genres
  # Extract the individual genres and count their occurrences
  label_counts <- table(unlist(data$genres))
  #label_counts
  # label_counts will be a data frame with "Var1" and "Freq" columns
  
  # Sort the counts in descending order
  label_counts <- sort(label_counts, decreasing = TRUE)


```

8.  **Using the ggplot2 Library**

```{r}
    # Load the ggplot2 library
    library(ggplot2)
    
    # Make sure you have label_counts data frame with "Var1" and "Freq" columns
    
    # Convert the table object to a data frame
    label_counts_df <- as.data.frame(label_counts)
    
    # Plot the bar chart using ggplot2
    ggplot(label_counts_df, aes(x = Var1, y = Freq)) +
      geom_bar(stat = "identity", fill = "skyblue") +
      labs(x = "Genre", y = "Number of Movies", title = "Number of Movies for Each Genre") +
      theme(axis.text.x = element_text(angle = 45, hjust = 1))


```

```         
Nearly half of the movies in the dataset are tagged as Drama. Also note that
one movie could belong to multiple genres.
```

## Problems

The problems for this part of the worksheet are:

-   *Problem 1*
-   *Problem 2*
-   *Problem 3*
-   *Problem 4*
-   *Problem 5*
-   *Problem 6*

## Problems

### Problem 1

Get the summary statistics (mean, median, min, max, 1st quartile, 3rd quartile and standard deviation). Calculate these only for the numerical columns. What can you determine from the summary statistics? What summary statistics can be useful for categorical columns? Classify all the variables/columns into their types of data attributes (nominal, ordinal, interval, ratio).

```{r}
library(ggplot2)

data = read.csv("movie_dataset.csv",header = TRUE)

numeric_column = c("budget","popularity","revenue","runtime","vote_count","vote_average")
summary_stat <- summary(data[,numeric_column])
summary_stat

#We can determine the outliers present in the data
#We can also find the range and the spread of the data.
#We can also check the skew of the data

#Mode/Frequency can be used for categorical columns

calculate_mode <-function(x){
  unx <- unique(x)
  unx[which.max(tabulate(match(x,unx)))]
}
mode_l <- calculate_mode(data$original_language)
print(mode_l)

#The summary statistics can be classified as
#Nominal <- Genre, ID, Original Language, Title, Director
#Ordinal <-
#Interval <- Release Date, 
#Ratio <- Budget, Popularity, Revenue, Runtime, Vote_average, Vote_count, 
```

### Problem 2

Investigate the data set for missing values. Also classify the missingness as MCAR, MAR or MNAR. Recommend ways to replace missing values in the dataset and apply them for revenue, budget and runtime columns.

*Hint:* Make sure to capture data from both, missing values in numeric fields and empty strings in descriptive fields. Convert all missing placeholders to type NA. Look at the distribution of the dataset to classify the type of missing values.

```{r}

#There are several values missing. The missing data values can be seen as
# a lot of columns have 0 or blank or NA values

#To get a correct estimate for missing values in numeric fields, we replace 0 with
# NA values.

data <- read.csv('movie_dataset.csv', header=TRUE)
data$budget <- ifelse(data$budget == 0, NA , data$budget)
data$revenue <- ifelse(data$revenue == 0, NA , data$revenue)
data$runtime <- ifelse(data$runtime == 0, NA , data$runtime)

#We can also change empty strings to NA values.

#The missingness of the data can be attributed to MCAR (Missing Completely at Random)

runtime_median <- median(data$runtime,na.rm=TRUE)
data$runtime <- ifelse(is.na(data$runtime),runtime_median,data$runtime)
data <- data[!is.na(data$runtime),]

```

### Problem 3

Analyze the spread of the data set along years. How number of movie releases have changed over the years ?

```{r}
#To check the spread of the data we can check the spread of the plot

library(ggplot2)
data = read.csv("movie_dataset.csv", header = TRUE)
numeric_column = c("budget","popularity","revenue","runtime","vote_count","vote_average")


selected_data = data[,numeric_column]
reshaped_data = stack(selected_data)
plot = ggplot(reshaped_data,aes(x=ind,y=values)) +  geom_boxplot() + labs(x = "Cols",y = "Val", title= "Box Plot") + theme_minimal() + facet_wrap(~ind,scales="free",nrow=1)

print(plot)

#To check the number of movies across the number of years

data$release_date <-as.Date(data$release_date, format = "%d-%m-%Y")
data$release_year <- format(data$release_date,"%Y")
data <- data[!is.na(data$release_year),]
list_years <- unique(data$release_year)
#print(list_years)

dist <- data.frame(year = list_years, count = numeric(length(list_years)))

for( i in 1:length(list_years)){
  
  year <- list_years[i]
  movies_in_year <- subset(data, release_year == year)
  movie_count <- nrow(movies_in_year)
  dist$count[i] <- movie_count
}

plot2 <- ggplot(dist, aes(x = factor(year), y = count)) + geom_bar(stat="identity",fill="lightblue") + labs(x = "Years", y = "Number of years", title= "Distribution of no of movies across the years.")  + theme_minimal()

print(plot2)

```

### Problem 4

Create a horizontal box plot using the column "runtime". What inferences can you make from this box and whisker plot? Comment on the skew of the runtime field (visual inspection is enough).

```{r}


data <- read.csv("movie_dataset.csv")

plot <- ggplot(data, aes(x = runtime,y = "Runtime")) + geom_boxplot() + labs(title = "Horizontal box plot for runtime",x="Runtime",y = "") + theme_minimal()

print(plot)

#We can see that the distribution of the runtime is around 100 minutes. There are a lot of outliers, although the majority of the values are centred around 100 to 120 minutes.

#The data is skewed more to the higher values ( left skewed data )

```

### Problem 5

Analyze the top 20 titles with highest budget, revenue and ROI. Plot a horizontal bar graph for all three metrics in each case. What analysis can you make by looking at these graphs? What kind of movies attracts the highest investments and do they promise a better ROI ?

```{r}
library(ggplot2)

ordered_data <- data[order(data$budget,decreasing = TRUE)]
top_20 <- head(ordered_data,20)
plot <- ggplot(top_20,aes(x="title",y="",))
```

### Problem 6

Put yourself in the shoes of a production house. You want to produce the next big blockbuster. Plot the ROI, revenue and budget across genres to finalize the genre of your upcoming movie as you did in the previous problem. Elaborate your answers with proper explanation. Since one movie can fall in multiple genre categories, you are free to choose a combination. You can also understand how the popularity of different genres have changed along the years. Do provide a nice name to your movie and your dream cast ;)
